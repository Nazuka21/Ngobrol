<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NGOBROL Walkie Talkie</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="firebase.js"></script>

  <!-- Style Wallpaper + UI -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #000;
      overflow: hidden;
      font-family: 'Orbitron', sans-serif;
      height: 100vh;
      width: 100vw;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Wallpaper Background - Hanya Border Neon */
    #wallpaper-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      max-width: calc(100vh * 9 / 16);
      max-height: calc(100vw * 16 / 9);
      margin: auto;
      border: 4px solid #00ff9d;
      border-radius: 12px;
      box-shadow: 0 0 40px #00ff9d, inset 0 0 25px rgba(0, 255, 157, 0.4);
      background: rgba(5, 20, 15, 0.85);
      backdrop-filter: blur(6px);
      pointer-events: none;
      z-index: 1;
      transition: 
        border-color 0.3s ease,
        box-shadow 0.3s ease,
        background 0.3s ease;
    }

    /* Container Utama Walkie Talkie */
    .container {
      max-width: 420px;
      margin: 24px auto;
      padding: 18px;
      border-radius: 18px;
      background: linear-gradient(180deg, #1b1b1b, #2b2b2b);
      border: 4px solid rgba(0, 230, 118, 0.12);
      box-shadow: 0 0 30px rgba(0, 230, 118, 0.12) inset;
      position: relative;
      z-index: 10;
      pointer-events: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    /* Jam & Tanggal di Atas */
    .clock-header {
      text-align: center;
      margin-bottom: 12px;
      padding: 12px;
      border: 2px solid var(--green);
      border-radius: 10px;
      background: rgba(0, 0, 0, 0.6);
    }

    .time {
      font-size: clamp(6vw, 8vmin, 10vmin);
      letter-spacing: 3px;
      color: #ffffff;
      text-shadow: 0 0 20px currentColor;
      margin-bottom: 4px;
      line-height: 1.1;
    }

    .date {
      font-size: clamp(3.5vw, 4.5vmin, 6vmin);
      color: #ffffff;
      text-shadow: 0 0 16px currentColor;
      line-height: 1.2;
    }

    /* Style Walkie Talkie */
    :root {
      --green: #00e676;
      --bg: #111;
      --card: #262626;
    }

    body {
      margin: 0;
      background: transparent;
      font-family: Consolas, monospace;
      color: var(--green);
      -webkit-font-smoothing: antialiased;
    }

    .radio-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .brand {
      font-weight: 700;
      font-size: 18px;
      color: var(--green);
    }

    .signal {
      font-size: 18px;
      color: #4caf50;
    }

    .radio-body {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .screen {
      background: #000;
      border: 2px solid var(--green);
      border-radius: 10px;
      padding: 14px;
      min-height: 140px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .info {
      font-size: 15px;
    }

    .meters {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      margin-top: 8px;
    }

    .online {
      margin-top: 10px;
      font-size: 13px;
      color: #8fe3a1;
    }

    .controls {
      margin-top: 8px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .room-select-row {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .room-select {
      flex: 1;
      padding: 12px;
      background: #000;
      color: var(--green);
      border: 2px solid var(--green);
      border-radius: 8px;
      font-size: 16px;
    }

    .updown {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .small {
      padding: 8px 10px;
      border-radius: 6px;
      background: #ddd;
      color: #000;
      font-weight: 600;
    }

    .ptt-row {
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: center;
    }

    .ptt {
      width: 220px;
      height: 100px;
      border-radius: 60px;
      background: red;
      color: #fff;
      font-size: 24px;
      border: none;
      box-shadow: 0 0 20px rgba(255, 0, 0, 0.35);
    }

    .ptt.active {
      box-shadow: 0 0 30px rgba(0, 230, 118, 0.9);
      background: linear-gradient(45deg, #ff5252, #ff1744);
    }

    .hold {
      background: #777;
      color: #fff;
      padding: 12px 18px;
      border-radius: 10px;
      border: none;
    }

    .auth-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 4px;
    }

    .input {
      padding: 8px;
      border-radius: 6px;
      background: #000;
      color: var(--green);
      border: 1px solid var(--green);
    }

    .auth-buttons {
      display: flex;
      gap: 8px;
    }

    .logout-row {
      display: flex;
      justify-content: flex-start;
      margin-top: 6px;
    }

    .hidden {
      display: none;
    }

    .radio-foot {
      font-size: 12px;
      color: #9f9;
      text-align: center;
      margin-top: 12px;
    }

    @media (max-width: 480px) {
      .container {
        margin: 8px;
      }
      .ptt {
        width: 180px;
        height: 80px;
      }
    }
  </style>

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

  <!-- Wallpaper Background (Hanya Border Neon) -->
  <div id="wallpaper-bg"></div>

  <!-- Walkie Talkie UI -->
  <div class="container">
    <!-- Jam & Tanggal di Atas -->
    <div class="clock-header">
      <div class="time" id="time">00:00:00:00</div>
      <div class="date" id="date">Sen, 01 Jan 2025</div>
    </div>

    <header class="radio-top">
      <div class="brand">Ngobrol Walkie</div>
      <div id="statusSignal" class="signal"></div>
    </header>

    <main class="radio-body">
      <section class="screen" id="screen">
        <div class="info"><span id="displayUser">-</span></div>
        <div class="info"><strong>Room:</strong> <span id="displayRoom">-</span></div>
        <div class="meters">
          <div>Sinyal: <span id="signalBar"></span></div>
          <div>Suara: <span id="audioLevel"></span></div>
        </div>
        <div id="onlineList" class="online"> Online: <span id="onlineCount">0</span></div>
      </section>

      <div class="controls">
        <div class="room-select-row">
          <select id="roomSelect" class="room-select"></select>
          <div class="updown">
            <button id="btnUp" class="small"> UP</button>
            <button id="btnDown" class="small"> DOWN</button>
          </div>
        </div>

        <div class="ptt-row">
          <button id="btnPTT" class="ptt">PTT</button>
          <button id="btnHold" class="hold">HOLD</button>
        </div>

        <div class="auth-row" id="authRow">
          <input id="email" placeholder="Email" class="input" />
          <input id="password" placeholder="Password" type="password" class="input" />
          <div class="auth-buttons">
            <button id="btnLogin" class="small">Login</button>
            <button id="btnRegister" class="small">Register</button>
          </div>
        </div>

        <div style="text-align:left;margin-top:8px;color:#9f9;font-size:12px;">
          Gunakan Dengan Bijak, Admin dan Developer Tidak Bertanggungjawab Atas Penyalahgunaannya!!!
        </div>

        <div class="logout-row">
          <button id="btnLogout" class="small hidden">Logout</button>
        </div>
      </div>
    </main>
    <footer class="radio-foot">Designed for All, PTT by Bogen Solo</footer>
  </div>

  <audio id="remoteAudio" autoplay></audio>

  <script>
    // === WALLPAPER JS - Berdenyut & Ganti Warna ===
    const colors = [
      { border: '#00ff9d', glow: 'rgba(0, 255, 157, 0.5)', bg: 'rgba(5, 20, 15, 0.85)' },
      { border: '#00f3ff', glow: 'rgba(0, 243, 255, 0.5)', bg: 'rgba(5, 15, 25, 0.85)' },
      { border: '#ff00ff', glow: 'rgba(255, 0, 255, 0.5)', bg: 'rgba(25, 5, 15, 0.85)' },
      { border: '#ffaa00', glow: 'rgba(255, 170, 0, 0.5)', bg: 'rgba(25, 15, 5, 0.85)' }
    ];
    let currentColorIndex = 0;
    let lastSecond = -1;

    function updateTime() {
      const now = new Date();
      const h = String(now.getHours()).padStart(2, '0');
      const m = String(now.getMinutes()).padStart(2, '0');
      const s = now.getSeconds();
      const ms = String(now.getMilliseconds()).padStart(3, '0').substring(0, 2);

      document.getElementById('time').textContent = `${h}:${m}:${s}:${ms}`;
      document.getElementById('date').textContent = now.toLocaleDateString('id-ID', {
        weekday: 'short',
        day: 'numeric',
        month: 'short',
        year: 'numeric'
      });

      if (s !== lastSecond) {
        lastSecond = s;
        currentColorIndex = (currentColorIndex + 1) % colors.length;
        applyColor(colors[currentColorIndex]);
      }
    }

    function applyColor(color) {
      const wallpaper = document.getElementById('wallpaper-bg');
      wallpaper.style.borderColor = color.border;
      wallpaper.style.boxShadow = `0 0 60px ${color.border}, inset 0 0 30px ${color.glow}`;
      wallpaper.style.background = color.bg;

      // Update juga border UI Walkie Talkie agar serasi
      const container = document.querySelector('.container');
      container.style.borderColor = `rgba(${parseInt(color.border.slice(1, 3), 16)}, ${parseInt(color.border.slice(3, 5), 16)}, ${parseInt(color.border.slice(5, 7), 16)}, 0.12)`;
      container.style.boxShadow = `0 0 30px ${color.border} inset`;
    }

    setInterval(updateTime, 10);
    updateTime();

    window.addEventListener('resize', () => {
      setTimeout(() => {
        applyColor(colors[currentColorIndex]);
      }, 100);
    });
  </script>

  <!-- App JS -->
  <script src="app.js"></script>

</body>
</html>